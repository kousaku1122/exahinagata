<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>アプリケーション雛形</title>
  </head>
  <body>
    <div>
      <input type="button" value="取得" onclick="findUsers()"/>
    </div>

    <input id="userName" type="text"/>
    <input id="age" type="number"/>
    <input type="button" value="追加" onclick="saveUser()"/>
    <div id="list"></div> 
    <script>
      const listArea = document.getElementById('list'); // リスト表示部

      // 全ユーザの取得
      function findUsers() {
        const url = '/findUsers'; // 通信先
        const req = new XMLHttpRequest(); // 通信用オブジェクト
        
        req.onreadystatechange = function() {
          if(req.readyState == 4 && req.status == 200) {
            alert(req.response);
          }
        }
        req.open('GET', url, true);
        req.send();
      }

      // ユーザの保存
      function saveUser() {
        const url = '/saveUser'; // 通信先
        const req = new XMLHttpRequest(); // 通信用オブジェクト

        // 名前と年齢
        const userName = document.getElementById('userName').value;
        const userAge = document.getElementById('age').value;

        // 取得した情報をもとにオブジェクトを作る
        const user = {name:userName, age:userAge};

        req.onreadystatechange = function() {
          if(req.readyState == 4 && req.status == 200) {
            alert(req.status);
          }
        }
        req.open('POST', url, true);
        req.setRequestHeader('Content-Type', 'application/json');
        req.send(JSON.stringify(user)); // オブジェクトを文字列化して送信
      }
    </script>
  </body>
</html>